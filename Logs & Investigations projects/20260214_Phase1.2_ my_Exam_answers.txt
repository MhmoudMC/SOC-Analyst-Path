SOC PHASE 1.2.3 EXAM - MY ANSWERS
==================================
Date: 2026-02-14
Analyst: [Your Name]

QUESTIONS I ANSWERED:
----------------------
1. Show all failed SSH login attempts
2. Show all successful SSH logins
3. Find all events from IP 45.155.205.233
4. Find all events with user "alice"
5. Show all suricata/firewall alerts
6. Top IPs with most failed logins
7. Most common usernames targeted
8. Timeline of failed logins by hour
9. IPs with both failed AND successful logins
10. Hosts with most authentication activity

MY SPL QUERIES:
---------------

1. Failed SSH attempts:
sourcetype=fakelog "Failed password"

2. Successful SSH logins:
sourcetype=fakelog "Accepted password"

3. Events from 45.155.205.233:
sourcetype=fakelog 45.155.205.233

4. Events with "alice":
sourcetype=fakelog alice

5. Firewall alerts:
sourcetype=fakelog (suricata OR "ET POLICY" OR "ET MALWARE")

6. Top IPs failed logins:
sourcetype=fakelog "Failed password" 
| rex "from (?<src_ip>\d+\.\d+\.\d+\.\d+)"
| stats count by src_ip 
| sort -count

7. Most targeted usernames:
sourcetype=fakelog "Failed password"
| rex "for (invalid user )?(?<username>\w+)"
| stats count by username
| sort -count

8. Timeline by hour:
sourcetype=fakelog "Failed password"
| bin span=1h _time
| stats count by _time

9. IPs with both failed & success:
sourcetype=fakelog
| rex "from (?<src_ip>\d+\.\d+\.\d+\.\d+)"
| eval outcome=if(searchmatch("Failed"),"fail","success")
| stats values(outcome) as outcomes by src_ip
| where mvcount(outcomes)>1

10. Hosts most activity:
sourcetype=fakelog
| stats count by host
| sort -count

KEY FINDINGS:
-------------
- 45.155.205.233 = 42 failed attempts (main brute force)
- 103.145.88.99 = 12 failed attempts
- 185.142.53.100 = 6 fails + 1 success (compromised alice)
- alice later did sudo cat /etc/shadow (credential harvesting)
- Cobalt Strike beacons detected at 20:15

TIME SPENT: [Your time]
NEXT: Ready for 1.3 Detection Engineering!